%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Exercises template
%
% Author: Francisco Luque Sánchez (@pacron on github)
%
% Feel free to download, use and share this template :)
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\documentclass[12pt]{article}       % class document and font size
\usepackage[utf8]{inputenc}         % allowance of accents (spanish writing)
\usepackage{indentfirst}

% packages for math fonts
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathtools}
\usepackage{amsthm}
\newtheorem{theorem}{Teorema}
\renewenvironment{proof}{{\noindent     \bfseries Demostración}\\}

\usepackage{fancyhdr}               % fancy header: customize your header
\usepackage{geometry}               % set margins in easy way

\geometry{a4paper, margin=1in}      % set 1 inch in every margin

% creation of \qed command to add a black square at the end of line
% \renewcommand*{\qed}{\hfill\ensuremath{\blacksquare}}

% header and footer customisation
\pagestyle{fancy}                   % pagestyle
\fancyhf{}                          % erase previous header and footer content
\rhead{Método de Euler en SED}           % right side of header (Usually document or chapter title)
\lhead{Métodos numéricos II}        % left side of header (Usually name)
\chead{}                            % center of header (useless piece of shit :D)
\rfoot{\thepage}                    % right side of footer (page number)
\lfoot{}                            % left side of footer (empty)
\cfoot{}                            % again a center

% Change the tolerance of hyphenation tool
\pretolerance=2000
\tolerance=3000

% Report title
\title{
    Método de Euler en sistemas de ecuaciones diferenciales \\              % Title
    \large Métodos numéricos II              % Subtitle
}

% Own author header
\author{
        María del Mar Ruiz Martín \\
        Antonio R. Moya Martín-Castaño \\
        Francisco Luque Sánchez \\
        Doble Grado de Ingeniería Informática y Matemáticas\\
        Universidad de Granada - UGR\\
        18001 Granada, \underline{Spain}
}
\date{\today}

\begin{document}
\maketitle

\section{Introducción}

En este trabajo explicaremos el método de Euler para resolución numérica de sistemas de ecuaciones diferenciales de primer orden. Este método es una extensión a sistemas de ecuaciones del método de Euler para ecuaciones diferenciales. Aunque no es muy utilizado en la práctica, ya que por sus características no aporta soluciones lo suficientemente buenas, sí que se suele explicar como introducción a los métodos de resolución numérica de ecuaciones diferenciales, dada su simplicidad. Además, es el más básico de lo que se conocen como \textit{métodos explícitos de resolución numérica de EDs}, y el más básico de los métodos de \textit{Runge-Kutta}. Por tanto, suele ser una buena estrategia introducir este método previo a la explicación de los métodos nombrados, ya que los mismos son una generalización de éste.\\

El trabajo irá estructurado de la siguiente forma. Primero, daremos una descripción general del concepto de sistema de ecuaciones diferenciales, ya que será el objeto sobre el que trabajaremos. Concretamente, nos centraremos en sistemas de ecuaciones diferenciales de primer orden. Tras esto, veremos cómo podemos transformar una ecuación diferencial de orden superior en un sistema de ecuaciones diferenciales de primer orden, con el fin de tratar una ecuación diferencial de orden superior con el método de Euler. Posteriormente, explicaremos el método de Euler y su aplicación a los sistemas de ecuaciones diferenciales. Completaremos este apartado con la resolución de dos ejemplos con este método. Por un lado, resolveremos un sistema de ecuaciones diferenciales de primer orden aplicando el método directamente, y por otro, tomaremos una ecuación de orden superior, la convertiremos en un sistema de ecuaciones, y resolveremos dicho sistema con el método nuevamente.\\

\section{Descripción general de un sistema de ecuaciones diferenciales}

Para comenzar, veamos lo que es una ecuación diferencial. Una ecuación diferencial es una igualdad en la que interviene una variable independiente ($t$), una variable dependiente ($x(t)$) y las sucesivas derivadas de la variable dependiente respecto de la independiente. En forma general, podemos escribir dicha ecuación de la siguiente forma:

$$ F(t, x, x', ..., x^{n)}) = 0 $$

Se define el orden de dicha ecuación diferencial como el mayor orden de derivación de la variable dependiente que aparece en dicha ecuación.\\

Una solución de esta ecuación es un conjunto de funciones que satisfacen las condiciones de dicha ecuación.\\

Asociado a esta ecuación diferencial, se define un problema de valores iniciales (PVI) como dicha ecuación diferencial junto con los $n$ valores siguientes. Fijado $t_0$:

$$ x(t_0) = y_0, x'(t_0) = y_1, ..., x_{n-1}(t_0) = y_{n-1} $$

Se dice que un PVI está bien planteado si existe solución, es única y depende de forma continua de los datos del problema.\\

Pasamos ahora a definir el concepto de sistema de ecuaciones diferenciales. Un sistema de ecuaciones diferenciales es un conjunto de ecuaciones diferenciales en las que se ven implicadas una variable independiente, un conjunto de variables dependientes de la misma, y las sucesivas derivadas de dichas variables dependientes respecto de la independiente. En forma general, podemos escribir un sistema de ecuaciones diferenciales como sigue:

$$
\begin{cases}
F_1(t, x_1, x_1', ..., x_1^{n_1)}, ..., x_m, x_m', ..., x_m^{n_m)}) = 0 \\
F_2(t, x_1, x_1', ..., x_1^{n_1)}, ..., x_m, x_m', ..., x_m^{n_m)}) = 0 \\
\vdots \\
F_r(t, x_1, x_1', ..., x_1^{n_1)}, ..., x_m, x_m', ..., x_m^{n_m)}) = 0
\end{cases}
$$

Al igual que para las ecuaciones diferenciales, la solución de un sistema de ecuaciones diferenciales está compuesto por un conjunto de ecuaciones que satisfacen las condiciones impuestas por las ecuaciones del sistema.\\

De nuevo, podemos definir un PVI asociado al sistema de ecuaciones anterior. Dicho PVI viene definido por el sistema de ecuaciones diferenciales más el siguiente conjunto de valores:
$$ x_1(t_0) = y_{10}, ..., x_1^{n_1-1)}(t_0) = y_{1n_1-1}, ..., x_m(t_0) = y_{m0}, ..., x_1^{n_m-1)}(t_0) = y_{mn_m-1} $$

Se dice que un sistema de ecuaciones diferenciales está bien planteado si cumple las propiedades definidas previamente:

\begin{itemize}
\item $\exists$ solución
\item Es única
\item Depende de forma continua de las propiedades del problema
\end{itemize}

Durante el trabajo, dado que el método de Euler se aplica a ecuaciones y sistemas de primer orden, trabajaremos con este tipo de sistemas. Podemos escribir este tipo de sistemas de la siguiente manera:

$$
\begin{cases}
F_1(t, x_1, ..., x_m) = \frac{d x_1}{d t} \\
F_2(t, x_1, ..., x_m) = \frac{d x_2}{d t} \\
\vdots \\
F_m(t, x_1, ..., x_m) = \frac{d x_m}{d t}
\end{cases}
$$

Y asociado a este sistema de ecuaciones, el PVI definido por el sistema anterior y el conjunto de valores:

$$ x_1(t_0) = y_1, x_2(t_0) = y_2, ..., x_m(t_0) = y_m $$

\section{Ecuaciones diferenciales de orden superior y reescritura como sistemas}

En la sección anterior definimos el concepto de ecuación diferencial de orden superior y el de sistema de ecuaciones diferenciales. Veamos ahora cómo reescribir una ecuación diferencial de orden $n$ en un sistema de ecuaciones diferenciales en el que se tienen $n$ ecuaciones diferenciales de primer orden. Este paso es necesario para poder aplicar posteriormente el método de Euler, ya que este método sólo puede ser aplicado a ecuaciones diferenciales de primer orden. Veamos entonces esta forma de reescribir las ecuaciones diferenciales de orden superior. Sea la ecuación diferencial de orden $n$: $ F(t, x, x', ..., x^{n)}) = 0 $. Podemos escribir el siguiente sistema de ecuaciones diferenciales, cuya solución es equivalente a la de la ecuación anterior. Tomamos los siguientes cambios de variable:

$$y_0 = x, y_1 = x', y_2 = x'', \dots, y_{n-1} = x^{n-1)}$$

Entonces, la solución de $y_0$ para el siguiente sistema de ecuaciones siguiente es la solución de la ecuación diferencial inicial:

$$
\begin{cases}
y_0' = x' = y_1\\
y_1' = x'' = y_2\\
\vdots\\
y_{n-2}' = x^{n-1)} = y_{n-1}\\
y_{n-1}' = x^{n)} = F(t, y_1, y_2, \dots, y_{n-1})
\end{cases}
$$

Una vez convertida la ecuación en el sistema anterior, estamos en condiciones de aplicar el método de Euler para resolverlo.

\section{Método de Euler para sistemas de ecuaciones diferenciales}

Recordemos primero el método de Euler para un problema de valores iniciales (PVI) bien planteado. Si tomamos N puntos equidistantes en un intervalo [a, b], de forma que para i=0,...,N:
$$
t_i=a+ih
$$
$$
h=(b-a)/N
$$
y dado el PVI:

$$
\begin{cases}
y'(t)=f(t,y(t)) \\ 
y(t_0)=y_0
\end{cases}
$$

Podemos tratar de aproximar la solución mediante el método de Euler. Mediante el desarrollo de Taylor centrado en $t_i$ evaluando en el punto $t_{i+1}$:
$$
y(t_{i+1})=y(t_i) + y'(t_i)(t_{i+1}-t_i) + y''(\xi_i)(t_{i+1}-t_i)^2/2
$$

para algún $\xi_i$ entre $(t_i, ti_{i+1})$.

Si observamos, lo escrito anteriormente es equivalente a:
$$
y(t_{i+1})=y(t_i) + f(t_i,y(t_i))h + y''(\xi_i)h^2/2,
$$ 

y lo que es lo mismo:

$$
y(t_{i+1})=y(t_i) + f(t_i,y(t_i))h + O(h^2).
$$

De este modo el método de Euler construye un $w_i \approx y(t_i)$ para cada $i=1,...,N$
$$
\begin{cases}
w_0=y_0\\
w_{i+1}=w_i + hf(t_i,w_i)
\end{cases}
$$

\section{Estudio del error y análisis de la convergencia del método}

Antes de comenzar con el estudio del error, comenzaremos definiendo los tipos de errores que se pueden encontrar cuando se utilizan métodos numéricos para resolución de ecuaciones diferenciales:

\begin{description}
\item[Error local] Se define como el error que se produce en un sólo paso del algoritmo, si se supone que el valor obtenido en la aproximación anterior es exacto.
\item[Error global] Se define como el error total cometido con la aproximación tras las $n$ iteraciones del método. Como veremos más adelante, no es la suma de los errores locales cometidos en todas las iteraciones, sino que se ve incrementado.
\item[Error de truncatura] Es el error que se produce por la precisión finita de las máquinas que se utilizan para computar los cálculos.
\end{description}

Estudiemos ahora los errores definidos en el método de Euler aplicado a sistemas de ecuaciones diferenciales.

\subsection{Error local}

Como ya hemos dicho antes, se define el error local como el que se produce en un paso del algoritmo, suponiendo que el valor del que partimos $(t_i, X_i)$ es un valor real de la ecuación. Entonces, tenemos que el error local cometido en la iteración $i+1$ lo podemos expresar como $E_{i+1} = ||X(t_{i+1}) - [X(t_{i}) + h*F(t_i, X_i)] ||$. Veamos cómo 

\begin{theorem} Error local del método de Euler.\\
El error local para el método de Euler es $O(h^2)$, donde $h$ es el tamaño del paso que hemos elegido para aplicar el método ($h=(b-a)/N$).
\end{theorem}

\begin{proof}
Veamos la demostración de dicho resultado. Tomamos el PVI asociado al sistema de ecuaciones diferenciales:
$$ X' = F(t, X),\, X(t_0) = X_0 $$
Supongamos que tenemos la el valor exacto para un determinado $t_i$, es decir, tenemos $(t_i, X_i)$ exacto. Entonces, el error local para la siguiente iteración es $E_{i+1} = ||X(t_{i+1}) - [X(t_{i}) + h*F(t_i, X_i)] ||$
\qed
\end{proof}

\section{Ejemplos y ejercicio resueltos}

\end{document}
